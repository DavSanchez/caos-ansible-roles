version: '3'

services:
  petclinic:
    build:
      context: .
      dockerfile: Dockerfile
      target: production
    ports:
      - 8080:8080
    environment:
      - SERVER_PORT=8080
      - NEW_RELIC_APP_NAME=JavaPetClinic
      - NEW_RELIC_LICENSE_KEY={{ new_relic_license_key }}
      - NEW_RELIC_HOST=staging-collector.newrelic.com
      - NEW_RELIC_API_HOST=staging.newrelic.com
      - NEW_RELIC_METRIC_INGEST_URI={{ metric_ingest_url }}/metric/v1
      - NEW_RELIC_EVENT_INGEST_URI={{ event_ingest_url }}/v1/accounts/events
      - NEW_RELIC_JFR_ENABLED=true
